## InnoDB没有锁升级

1. 锁升级(Lock Escalation)是指将当前锁的粒度降低。举例来说,数据库可以把一个表的1000个行锁升级为一个页锁,或者将页锁升级为表锁。如果在数据库的设计中认为锁是一种稀有资源,而且想避免锁的开销,那数据库中会频繁出现锁升级现象。
1. **InnoDB存储引擎不存在锁升级的问题**。
    1. InnoDB不是根据每个记录来产生行锁的；
    2. 是根据每个事务访问的每个页对锁进行管理的,采用的是位图的方式。
    1. 因此不管个事务锁住页中一个记录还是多个记录,其开销通常都是一致的。


    1. 假设一张表有3000000个数据页,每个页大约有100条记录,那么总共有300000000条记录。
    1. 若有一个事务执行全表更新的SQL语句,则需要对所有记录加锁。若根据每行记录产生锁对象进行加锁,并且每个锁占用10字节,则仅对锁管理就需要差不多需要3GB的内存。
    1. 而 InnoDB存储引擎根据页进行加锁,并采用位图方式,假设每个页存储的锁信息占用30个字节,则锁对象仅需90MB的内存。由此可见两者对于锁资源开销的差距之大。

