## 简述 Spring AOP 的原理

### 什么是AOP
使用OOP面向对象编程有一些弊端，当需要为多个不具有继承关系的对象引入同一个公共行为时，例如日志、安全检测等，我们只有在每个对象里引入公共行为，这样程序中就产生了大量的重复代码，程序就不便于维护了。所以就有了一个面向对象编程的补充，即面向方面编程，AOP所关注的方向是横向的，不同于OOP的纵向。

### 特点
- 降低模块之间的耦合度
- 使系统容易扩展
- 更好的代码复用

### 相关概念
1. 切面（Aspect）：一个关注点的模块化，这个关注点可能会横切多个对象。
1. 连接点（Joinpoint）：程序执行过程中某一行为。
1. 通知（Advice）：“切面”对于某个“连接点”所产生的动作。
1. 切入点（Pointcut）：匹配连接点的断言，在AOP中通知和一个切入点表达式关联。
1. 目标对象（Target Object）：被一个或者多个切面所通知的对象。
1. AOP代理（AOP Proxy） 在Spring AOP有两种代理方式，JDK动态代理和CGLIB代理。


- Spring提供了两种方式来生成代理对象:JDKProxy和Cglib，具体使用哪种方式是由配置来决定。
- 默认的策略是如果目标类是接口，则使用JDK动态代理技术，否则使用Cglib来生成代理。


### Spring AOP的原理
Spring AOP采用的是动态代理，在运行期间对业务方法进行增强，所以不会生成新类。对于动态代理技术，
- Spring提供了两种方式来生成代理对象:JDKProxy和Cglib，具体使用哪种方式是由配置来决定。
- 默认的策略是如果目标类是接口，则使用JDK动态代理技术，否则使用Cglib来生成代理。
 1. DK动态代理只能为接口创建动态代理实例，而不能对类创建动态代理。需要获得被目标类的接口信息（应用Java的反射技术），生成一个实现了代理接口的动态代理类（字节码），再通过反射机制获得动态代理类的构造函数，利用构造函数生成动态代理类的实例对象，在调用具体方法前调用invokeHandler方法来处理。
1. CGLib动态代理需要依赖asm包，把被代理对象类的class文件加载进来，修改其字节码生成子类。但是Spring AOP基于注解配置的情况下，需要依赖于AspectJ包的标准注解，但是不需要额外的编译以及AspectJ的织入器，而基于XML配置不需要。
