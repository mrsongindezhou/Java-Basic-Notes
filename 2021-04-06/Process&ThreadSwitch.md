## 为什么进程切换慢，线程切换快？


- 每个进程都有自己的虚拟地址空间，进程内的所有线程共享进程的虚拟地址空间。

#### 进程切换和线程切换的区别
最主要的一个区别在于进程切换涉及虚拟地址空间的切换而线程不会。
###### 进程：
- **页表查找**：因为进程都有自己的虚拟地址空间，把虚拟地址转换为物理地址需要查找页表，页表查找是一个很慢的过程
- **TLB加速**：因此通常使用Cache来缓存常用的地址映射，这样可以加速页表查找，这个cache就是TLB
- **切换后TLB失效**：因为每个进程都有自己的页表，那么当进程切换后页表也要进行切换，页表切换后TLB就失效了，cache失效导致命中率降低
- **运行变慢**：虚拟地址转换为物理地址就会变慢，表现出来的就是程序运行会变慢
###### 线程：
- 线程切换则不会导致TLB失效，因为线程线程无需切换地址空间

#### 什么是虚拟内存
- 虚拟内存：虚拟内存是操作系统为每个进程提供的一种抽象，每个进程都有属于自己的、私有的、地址连续的虚拟内存。
- 页表：虚拟地址空间和物理地址的映射关系保存在页表中。

#### 什么是TLB
Translation Lookaside Buffer，TLB本质上就是一个cache，是用来加速页表查找的